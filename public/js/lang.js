const languageFile = {
    pilots: {
        en: "Pilots",
        ar: "الطيار",
    },
    drones:{
        en: "Drones",
        ar: "الطائرات بدون طيار",
    },
    missions: {
        en: "Missions",
        ar: "المهام",
    },
    reigons: {
        en: "Regions",
        ar: "المناطق",
    },
    locations: {
        en: "Locations",
        ar: "المواقع",
    },
    missionAnaltyics: {
        en: "Missions Analytics",
        ar: "تحليل المهام",
    },
    noDataFound: {
        en: "No data found",
        ar: "لا توجد بيانات",
    },
    latestMissions: {
        en: "Latest Missions",
        ar: "آخر المهام",
    },
    "loading...": {
        en: "Loading...",
        ar: "...تحميل",
    },
    latestIncidents: {
        en: "Latest Incidents",
        ar: "آخر الأحداث",
    },
    pilotTracking: {
        en: "Pilot Tracking",
        ar: "تتبع الطيار",
    },
    startDate: {
        en: "Start Date",
        ar: "تاريخ البدء",
    },
    endDate: {
        en: "End Date",
        ar: "تاريخ الانتهاء",
    },
    pending: {
        en: "Pending",
        ar: "قيد الانتظار",
    },
    finished: {
        en: "Finished",
        ar: "منتهية ",
    },
    totalMissions: {
        en: "Total Missions",
        ar: "إجمالي المهام",
    },
    loading: {
        en: "Loading",
        ar: "تحميل",
    },
    centeralRegion: {
        en: "Central Region",
        ar: "المنطقة الوسطى",
    },
    "missions:": {
        en: "Missions :",
        ar: ": المهام",
    },
    easternRegion: {
        en: "Eastern Region",
        ar: "المنطقة الشرقية",
    },
    WesternRegion: {
        en: "Western Region",
        ar: "المنطقة الغربية",
    },
    restView: {
        en: "Reset View",
        ar: "إعادة عرض",
    },
    "totalMissions:": {
        en: "Total Missions :",
        ar: ": إجمالي المهام",
    },
    dashboard: {
        en: "Dashboard",
        ar: "لوحة التحكم",
    },
    locations: {
        en: "Locations",
        ar: "المواقع",
    },
    users: {
        en: "Users",
        ar: "المستخدمين",
    },
    Dashboard: {
        en: "Dashboard",
        ar: "لوحة التحكم",
    },
    Missions: {
        en: "Missions",
        ar: "المهام",
    },
    Locations: {
        en: "Locations",
        ar: "المواقع",
    },
    Users: {
        en: "Users",
        ar: "المستخدمين",
    },
    Drones: {
        en: "Drones",
        ar: "طيار",
    },
    missionControl: {
        en: "Mission Control",
        ar: "التحكم في المهمة",
    },
    missionList: {
        en: "Mission List",
        ar: "قائمة المهام",
    },
    inspectionType: {
        en: "Inspection Type",
        ar: "نوع الفحص",
    },
    missionDate: {
        en: "Mission Date",
        ar: "تاريخ المهمة",
    },
    location: {
        en: "Location",
        ar: "الموقع",
    },
    status: {
        en: "Status",
        ar: "الحالة",
    },
    "status:": {
        en: "Status:",
        ar: "الحالة:",
    },
    actions: {
        en: "Actions",
        ar: "الإجراءات",
    },
    qss_admin: {
        en: "QSS Admin",
        ar: "مسؤول QSS",
    },
    modon_admin: {
        en: "Modon Admin",
        ar: "مسؤول مدن",
    },
    region_manager: {
        en: "Region Manager",
        ar: "مدير المنطقة",
    },
    pilot: {
        en: "Pilot",
        ar: "طيار",
    },
    Pilot: {
        en: "Pilot",
        ar: "طيار",
    },
    city_manager: {
        en: "City Manager",
        ar: "مدير المدينة",
    },
    selectProgram: {
        en: "Select Program",
        ar: "اختر البرنامج",
    },
    threeD_Mappings: {
        en: "3D Mappings",
        ar: " الخرائط ثلاثية الأبعاد ",
    },
    Gas_Emission_Analysis: {
        en: "Gas Emission Analysis",
        ar: "تحليل انبعاثات الغازات",
    },
    Road_Damage_Monitoring: {
        en: "Road Damage Monitoring",
        ar: "مراقبة أضرار الطرق ",
    },
    Remote_Security_Inspections: {
        en: "Remote Security Inspections",
        ar: " فحوصات أمنية عن بُعد ",
    },
    Emergency_Response_Support: {
        en: "Emergency Response Support",
        ar: "دعم الاستجابة للطوارئ",
    },
    City_Updates_and_Event_Coverages: {
        en: "City Updates $ Event Coverages",
        ar: "تحديثات المدينة وتغطيات الأحداث",
    },
    Yard_Violations_Detections: {
        en: "Yard Violations Detections",
        ar: "الكشف عن انتهاكات الفناء",
    },
    region: {
        en: "Region",
        ar: "المنطقة",
    },
    "region:": {
        en: "Region: ",
        ar: "المنطقة:  ",
    },
    location:{
        en: "Location",
        ar: "الموقع",
    },
    latitude:{
        en: "Latitude",
        ar: "خط العرض",
    },
    longitude:{
        en: "Longitude",
        ar: "خط الطول",
    },
    notes:{
        en: "Notes",
        ar: "ملاحظات",
    },
    createMission:{
        en: "Create Mission",
        ar: "إنشاء مهمة",
    },
    create_new_Mission: {
        en: "Create New Mission",
        ar: "إنشاء مهمة جديدة",
    },
    geoCoordinates: {
        en: "Geo Coordinates",
        ar: "إحداثيات جغرافية",
    },
    pilotName: {
        en: "Pilot Name",
        ar: "اسم الطيار",
    },
    missionCreatedBy: {
        en: "Mission Created By",
        ar: " تم انشاء المهمة بواسطة ",
    },
    note:{
        en: "Note",
        ar: "ملاحظة",
    },
    program: {
        en: "Program",
        ar: "برنامج",
    },
    missionApproval: {
        en: "Mission Approval",
        ar: "موافقة المهمة",
    },
    modonAdmin: {
        en: "MODON Admin:",
        ar: "مسؤول MODON",
    },
    regionManager: {
        en: "Region Manager:",
        ar: "مدير المنطقة",
    },
    previous: {
        en: "Previous",
        ar: "السابق",
    },
    next: {
        en: "Next",
        ar: "التالي",
    },
    approved: {
        en: "Approved",
        ar: "موافق عليه",
    },
    Approved: {
        en: "Approved",
        ar: "موافق عليه",
    },
    rejected: {
        en: "Rejected",
        ar: "مرفوض",
    },
    Rejected: {
        en: "Rejected",
        ar: "مرفوض",
    },
    pending: {
        en: "Pending",
        ar: "قيد الانتظار",
    },
    Pending: {
        en: "Pending",
        ar: "قيد الانتظار",
    },
    completed: {
        en: "Completed",
        ar: "مكتمل",
    },
    Completed: {
        en: "Completed",
        ar: "مكتمل",
    },
    awaitingReport: {
        en: "Awaiting Report",
        ar: "في انتظار التقرير",
    },
    Awaiting_Report: {
        en: "Awaiting Report",
        ar: "في انتظار التقرير",
    },
    inProgress: {
        en: "In Progress",
        ar: "قيد التقدم",
    },
    In_Progress: {
        en: "In Progress",
        ar: "قيد التقدم",
    },
    reportDetail: {
        en: "Report Detail",
        ar: "تفاصيل التقرير",
    },
    description: {
        en: "Description",
        ar: "الوصف",
    },
    images: {
        en: "Images",
        ar: "الصور",
    },
    //locationspage
    locationsControl: {
        en: "Locations Control",
        ar: "تحكم المواقع",
    },
    locationsList: {
        en: "Locations List",
        ar: "قائمة المواقع",
    },
    no: {
        en: "No.",
        ar: ":رقم",
    },
    map: {
        en: "Map",
        ar: "خريطة",
    },
    createNewLocation: {
        en: "Create New Location",
        ar: "إنشاء موقع جديد",
    },
    createNewMission: {
        en: "Create New Mission",
        ar: "إنشاء مهمة جديدة",
    },
    locationName: {
        en: "Location Name",
        ar: "اسم الموقع",
    },
    updateLocation: {
        en: "Update Location",
        ar: "تحديث الموقع",
    },
    updateMission: {
        en: "Update Mission",
        ar: "تحديث المهمة",
    },
    createLocation: {
        en: "Create Location",
        ar: "إنشاء موقع",
    },
    createMission: {
        en: "Create Mission",
        ar: "إنشاء مهمة",
    },
    completedMissions: {
        en: "Completed Missions",
        ar: "المهام المكتملة",
    },
    central: {
        en: "Central",
        ar: "الوسطى",
    },
    eastern: {
        en: "Eastern",
        ar: "الشرقية",
    },
    western: {
        en: "Western",
        ar: "الغربية",
    },
    Jeddah_First_Industrial_City: { // Added this key
        en: "Jeddah First Industrial City",
        ar: "مدينة جدة الصناعية الأولى",
    },
    Jeddah_Second_Industrial_City: { // Added this key
        en: "Jeddah Second Industrial City",
        ar: "مدينة جدة الصناعية الثانية",
    },
    Waha_Jeddah: { // Added this key
        en: "Waha Jeddah",
        ar: "واحة جدة",
    },
    Makkah: { // Added this key
        en: "Makkah",
        ar: "مكة",
    },
    Jeddah_Third_Industrial_City: { // Added this key
        en: "Jeddah Third Industrial City",
        ar: "مدينة جدة الصناعية الثالثة",
    },
    Riyadh_First_Industrial_City: { // Added this key
        en: "Riyadh First Industrial City",
        ar: "مدينة الرياض الصناعية الأولى",
    },
    Riyadh_Second_Industrial_City: { // Added this key
        en: "Riyadh Second Industrial City",
        ar: "مدينة الرياض الصناعية الثانية",
    },
    "Al-Kharj": { // Added this key
        en: "Al-Kharj",
        ar: "الخرج",
    },
    Sudair: { // Added this key
        en: "Sudair",
        ar: "سدير",
    },
    Dammam_First_Industrial_City: { // Added this key
        en: "Dammam First Industrial City",
        ar: "مدينة الدمام الصناعية الأولى",
    },
    Dammam_Second_Industrial_City: { // Added this key
        en: "Dammam Second Industrial City",
        ar: "مدينة الدمام الصناعية الثانية",
    },
    Dammam_Third_Industrial_City: { // Added this key
        en: "Dammam Third Industrial City",
        ar: "مدينة الدمام الصناعية الثالثة",
    },
    "Al-Ahsa": { // Added this key
        en: "Al-Ahsa",
        ar: "الأحساء",
    },
    "Hafar-Al-Batin": { // Added this key
        en: "Hafar Al-Batin",
        ar: "حفر الباطن",
    },
    missionDescription: {
        en: "Mission Description",
        ar: "وصف المهمة",
    },
    all: {
        en: "All",
        ar: "الكل",
    },
    generalManager: {
        en: "General Manager",
        ar: "المدير العام",
    },
    view: {
        en: "View",
        ar: "عرض",
    },
    editProfile: {
        en: "Edit Profile",
        ar: "تعديل الملف الشخصي",
    },
    logout: {
        en: "Logout",
        ar: "تسجيل الخروج",
    },
    resetPassword: {
        en: "Reset Password",
        ar: "إعادة تعيين كلمة المرور",
    },
    currentPassword: {
        en: "Current Password",
        ar: "كلمة المرور الحالية",
    },
    newPassword: {
        en: "New Password",
        ar: "كلمة المرور الجديدة",
    },
    confirmNewPassword: {
        en: "Confirm New Password",
        ar: "تأكيد كلمة المرور الجديدة",
    },
    updatePassword: {
        en: "Update Password",
        ar: "تحديث كلمة المرور",
    },
    selectRegions: {
        en: "Select Regions",
        ar: "اختر المناطق",
    },
    qssAdminPanel: {
        en: "QSS Admin Panel",
        ar: "لوحة تحكم QSS",
    },
    adminControl: {
        en: "Admin Control",
        ar: "تحكم المشرف",
    },
    avatar: {
        en: "Avatar",
        ar: "الصورة",
    },
    name: {
        en: "Name",
        ar: "الاسم",
    },
    email: {
        en: "Email",
        ar: "البريد الإلكتروني",
    },
    type: {
        en: "Type",
        ar: "النوع",
    },
    fullName: {
        en: "Full Name",
        ar: "الاسم الكامل",
    },
    selectUserType: {
        en: "Select User Type",
        ar: "اختر نوع المستخدم",
    },
    assignedRegions: {
        en: "Assigned Regions",
        ar: "المناطق المخصصة",
    },
    profileImage: {
        en: "Profile Image",
        ar: "صورة الملف الشخصي",
    },
    createNewUser: {
        en: "Create New User",
        ar: "إنشاء مستخدم جديد",
    },
    createUser: {
        en: "Create User",
        ar: "إنشاء مستخدم",
    },
    droneControl: {
        en: "Drone Control",
        ar: "التحكم في الطائرة  ",
    },
    drones: {
        en: "Drones",
        ar: "الطائرات بدون طيار",
    },
    serialNumber: {
        en: "Serial Number",
        ar: "الرقم التسلسلي",
    },
    assignedTo: {
        en: "Assigned To",
        ar: "مخصص لـ",
    },
    model: {
        en: "Model",
        ar: "موديل",
    },
    selectPilot: {
        en: "Select Pilot",
        ar: "اختر الطيار",
    },
    addDrone: {
        en: "Add Drone",
        ar: "إضافة طائرة  ",
    },
    addNewDrone: {
        en: "Add New Drone",
        ar: "إضافة طائرة جديدة  ",
    },
    noMissionsFound: {
        en: "No Missions Found !!!",
        ar: "لم يتم العثور على مهام !!!",
    },
    pilotMissions: {
        en: "Pilot Missions",
        ar: "مهام الطيار",
    },
    "program:": {
        en: "Program: ",
        ar: "البرنامج: ",
    },
    "location:": {
        en: "Location: ",
        ar: "الموقع: ",
    },
    "geoCordinates:": {
        en: "Geo Cordinates: ",
        ar: "الإحداثيات الجغرافية: ",
    },
    "missionCreatedby:": {
        en: "Mission Created by: ",
        ar: "تم إنشاء المهمة بواسطة: ",
    },
    "note:": {
        en: "Note: ",
        ar: "ملاحظة: ",
    },
    detailedSummary: {
    en: "Detailed Summary",
    ar: "ملخص تفصيلي",
    },
    missionCreatedBy: {
        en: "Mission Created By",
        ar: "أنشأ المهمة",
    },
    videoLink: {
        en: "Video Link",
        ar: "رابط الفيديو",
    },
    reportDetail: {
        en: "Report Detail",
        ar: "تفاصيل التقرير",
    },
    clickToUploadImages: {
    en: "Click to Upload Images",
    ar: "انقر لتحميل الصور",
    },
    submitReport: {
    en: "Submit Report",
    ar: "إرسال التقرير",
    },
    submitANewReport: {
        en: "Submit a New Report",
        ar: "إرسال تقرير جديد",
    },
    updateReport: {
    en: "Update Report",
    ar: "تحديث التقرير",
    },
    allFieldsAreRequired: {
        en: "All fields are required",
        ar: "جميع الحقول مطلوبة",
    },
    currentImages: {
        en: "Current Images",
        ar: "الصور الحالية",
    },
    editReport: {
    en: "Edit Report",
    ar: "تعديل التقرير",
    },
    uploadNewImages: {
        en: "Upload New Images",
        ar: "تحميل صور جديدة",
    },
    approve: {
        en: "Approve",
        ar: "موافقة",
    },
    reject: {
        en: "Reject",
        ar: "رفض",
    }
};

function updateLanguageTexts(lang) {

    $("[data-lang-key]").each(function () {
        const key = $(this).data("lang-key");
        //console.log(key);
        const translation = languageFile[key]?.[lang];
        if (translation) {
            $(this).text(translation);
        }
    });
}
// Function to initialize or update tooltips
function initializeTooltips(selectedLang) {
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    tooltipTriggerList.forEach(el => {
        const content = el.getAttribute('data-title'); // Get content from custom attr

        // Set the tooltip title based on the selected language
        const tooltipTitle = selectedLang === "ar" 
            ? `<strong class="text-dark"><span data-lang-key="missionDescription">${languageFile.missionDescription.ar}</span></strong><br>${content}`
            : `<strong class="text-dark"><span data-lang-key="missionDescription">${languageFile.missionDescription.en}</span></strong><br>${content}`;

        // Destroy existing tooltip instance if any
        if (el._tooltipInstance) {
            el._tooltipInstance.dispose();
        }

        // Reinitialize the tooltip with the updated title
        el._tooltipInstance = new bootstrap.Tooltip(el, {
            html: true,
            title: tooltipTitle,
            customClass: 'custom-tooltip'
        });
    });
}

$(document).ready(function () {

    // Get language from localStorage, fallback to English
    let currentLang = localStorage.getItem("selectedLang") || "ar";
    localStorage.setItem("selectedLang", currentLang);
     // Initialize tooltips on page load
     initializeTooltips(currentLang);
    // Flag map to set correct flag on page load
    const flagMap = {
        en: "./images/en.png",
        ar: "./images/ar.png",
    };
    
    // Load language and flag on page load
    $(".selected-flag").attr("src", flagMap[currentLang]);


    // Function to update text direction
    function updateTextDirection(lang) {
        $("body").attr("dir", lang === "ar" ? "rtl" : "ltr");
    }
    console.log("currentLang: ", currentLang);
    // Initialize language texts and direction
    updateLanguageTexts(currentLang);
    // updateTextDirection(currentLang);
    updateTextDirection(currentLang);

    adjustModalHeaderDirection(currentLang);
    // Update language on dropdown click
    $(".lang-option").on("click", function (e) {
        e.preventDefault();

        // Get the clicked flag image source
        const selectedFlag = $(this).find('img').attr('src');

        // Set the selected flag image
        $(".selected-flag").attr("src", selectedFlag);

        // Optionally, store in localStorage
        const selectedLang = $(this).data("lang");
        localStorage.setItem("selectedLang", selectedLang);


        updateLanguageTexts(selectedLang);
        if ($('#locationId').val()) {
            $(".form-title-mission").text(languageFile.updateLocation[selectedLang]);
            $(".mission-btn span").text(languageFile.updateLocation[selectedLang]);
        } else {
            $(".form-title-mission").text(languageFile.createNewMission[selectedLang]);
            $(".mission-btn span").text(languageFile.createLocation[selectedLang]);
        }
   
        
        $('#langDropdown').removeClass('active');
        updateTextDirection(selectedLang);
        adjustModalHeaderDirection(selectedLang);

      
        // Call the tooltip initialization function
        initializeTooltips(selectedLang);
        loadInspectionTypes(selectedLang);
   
      

         // Notify adminusers.js to update the chart
    if (typeof updateChartLanguage === "function") {
        updateChartLanguage(selectedLang); // Call the function from adminusers.js
    }

    });

    
    function adjustModalHeaderDirection(selectedLang) {
     
        
        if (selectedLang === 'ar') {
            $('#passwordCloseHeaderBtn').css('margin', '0');
        } else {
        
           
            $('#passwordCloseHeaderBtn').removeAttr('style');
        }
        
    }



    
});